<div id="page-title">
	<div id="page-meta">
		<div class="aux-actions">
			<a class="btn btn-default btn-outline" ng-if="!ngCtrl.list.system" ng-click="ngCtrl.deleteListModal()"><i class="fa fa-trash-o go-red"></i> <span translate="{{'RECORD_LIST_DELETE'}}"></span></a>
			<a class="btn btn-default btn-outline disabled" ng-if="ngCtrl.list.system" href="javascript:void(0)"><i class="fa fa-lock"></i> <span translate="{{'DELETE_LOCKED'}}"></span></a>
		</div>
		<div class="meta-label">
			<h4><span class="go-gray" translate="{{'RECORD_LIST_TITLE_PREFIX'}}"></span> {{ngCtrl.list.name}}</h4>
		</div>
	</div>

</div>
<div id="page-body" style="padding-bottom:3em; ">
	<div class="tabbable tabs-left spilled">
		<a class="back" href="#/admin/entities/{{::ngCtrl.entity.name}}/lists"><i class="fa fa-fw fa-arrow-left"></i> <span class="text" translate="{{'BACK'}}"></span></a>
		<ul class="nav nav-tabs">
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}"><i class="fa fa-fw fa-info-circle"></i> <span class="text" translate="{{'DETAILS'}}"></span></a></li>
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}/fields"><i class="fa fa-fw fa-table"></i> <span class="text" translate="{{'FIELDS'}}"></span></a></li>
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}/views"><i class="fa fa-fw fa-file-text-o"></i> <span class="text" translate="{{'RECORD_VIEWS'}}"></span></a></li>
			<li class="active"><a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists"><i class="fa fa-fw fa-list"></i> <span class="text" translate="{{'RECORD_LISTS'}}"></span></a></li>
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}/trees"><i class="fa fa-fw fa-sitemap"></i> <span class="text" translate="{{'RECORD_TREES'}}"></span></a></li>
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}/relations"><i class="fa fa-fw fa-link"></i> <span class="text" translate="{{'RELATIONS'}}"></span></a></li>
		</ul>

	</div>
	<div id="page-text">
		<nav class="navbar navbar-default navbar-erp">
			<div class="container-fluid">
				<ul class="nav navbar-nav">
					<li role="presentation">
						<a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists/{{::ngCtrl.list.name}}" translate="{{'RECORD_LIST_TAB_BASIC'}}"></a>
					</li>
					<li role="presentation">
						<a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists/{{::ngCtrl.list.name}}/columns" translate="{{'RECORD_LIST_TAB_COLUMNS'}}"></a>
					</li>
					<li role="presentation">
						<a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists/{{::ngCtrl.list.name}}/query-sort" translate="{{'RECORD_LIST_TAB_QUERY_SORT'}}"></a>
					</li>
					<li role="presentation" class="active">
						<a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists/{{::ngCtrl.list.name}}/actions" translate="{{'RECORD_LIST_TAB_QUERY_ACTIONS'}}"></a>
					</li>
				</ul>
			</div>
		</nav>
		<h4 style="margin-bottom:1em" translate="{{'RECORD_LIST_TAB_ACTIONS_SERVICE_TITLE'}}"></h4>
		<p translate="{{'RECORD_LIST_TAB_ACTIONS_SERVICE_DESCRIPTION'}}"></p>
		<a class="btn btn-default btn-outline" href="javascript:void(0)" ng-click="ngCtrl.manageServiceCodeModal()" translate="{{'MANAGE_CODE'}}"></a> 
		<span class="divider">|</span>
		<span class="ng-hide" ng-show="!ngCtrl.list.serviceCode" translate="{{'RECORD_LIST_TAB_ACTIONS_SERVICE_STATUS_DEFAULT'}}"></span>
		<span class="ng-hide" ng-show="ngCtrl.list.serviceCode" translate="{{'RECORD_LIST_TAB_ACTIONS_SERVICE_STATUS_CUSTOM'}}"></span>

		<h4 style="margin-bottom:1em;margin-top:2em;" translate="{{'RECORD_LIST_TAB_ACTIONS_TEMPLATES_TITLE'}}"></h4>
		<p translate="{{'RECORD_LIST_TAB_ACTIONS_TEMPLATES_DESCRIPTION'}}"></p>
		<a class="btn btn-default btn-outline" href="javascript:void(0)" ng-click="ngCtrl.addManageActionItemModal(null)" translate="{{'ADD_NEW'}}"></a>
		<table class="table table-bordered table-hover table-vertical-align-middle ng-hide" style="margin-top:1em;" ng-show="ngCtrl.list.actionItems.length > 0">
			<thead>
				<tr>
					<th width="30"></th>
					<th width="200" translate="{{'MENU'}}"></th>
					<th width="30" translate="{{'WEIGHT'}}"></th>
					<th translate="{{'NAME'}}"></th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="actionItem in ngCtrl.list.actionItems track by actionItem.name">
					<td><a class="btn btn-default btn-outline"  href="javascript:void(0)" ng-click="ngCtrl.addManageActionItemModal(actionItem)"><i class="fa fa-fw fa-pencil"/></a></td>
					<td ng-bind="actionItem.menu"></td>
					<td ng-bind="actionItem.weight"></td>
					<td ng-bind="actionItem.name"></td>
				</tr>
			</tbody>
		</table>
	</div>
</div>


<script type="text/ng-template" id="deleteListModal.html">
	<div class="modal-header" id="modal-top">
		<button type="button" class="close" ng-click="popupCtrl.cancel('cancel')" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<h3 class="modal-title" translate="{{'RECORD_LIST_DELETE_MODAL_TITLE'}}"></h3>
	</div>
	<div class="modal-body">
		<div class="alert alert-danger" ng-bind="popupCtrl.errorMessage" ng-show="popupCtrl.hasError"></div>
		<div ng-hide="popupCtrl.hasError">
			<p translate="{{'RECORD_LIST_DELETE_MODAL_QUESTION'}}"></p>
		</div>
	</div>
	<div class="modal-footer">
		<button class="btn btn-danger" ng-click="popupCtrl.ok()" ng-hide="popupCtrl.hasError" translate="{{'RECORD_LIST_DELETE'}}"></button>
		<button class="btn btn-default" ng-click="popupCtrl.cancel()" translate="{{'CANCEL'}}"></button>
	</div>
</script>

<script type="text/ng-template" id="manageServiceCodeModal.html">
	<div class="modal-header" id="modal-top">
		<button type="button" class="close" ng-click="popupCtrl.cancel('cancel')" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<h3 class="modal-title" translate="{{'RECORD_LIST_MANAGE_SERVICE_CODE_MODAL_TITLE'}}"></h3>
	</div>
	<div class="modal-body">
		<p><span translate="{{'RECORD_LIST_MANAGE_SERVICE_CODE_MODAL_DESCRIPTION_1'}}"></span> <a href="javascript:void(0)" ng-click="popupCtrl.loadDefaultScript()" style="text-transform:lowercase" translate="{{'CLICK_HERE'}}"></a> <span translate="{{'RECORD_LIST_MANAGE_SERVICE_CODE_MODAL_DESCRIPTION_2'}}"></span></p>
		<div ui-ace="popupCtrl.aceOptions" ng-model="popupCtrl.serviceCode" style="height:400px;"></div>
	</div>
	<div class="modal-footer">
		<button class="btn btn-primary" ng-click="popupCtrl.ok()" ng-hide="popupCtrl.hasError" translate="{{'SAVE'}}"></button>
		<button class="btn btn-default" ng-click="popupCtrl.cancel()" translate="{{'CANCEL'}}"></button>
	</div>
</script>

<script type="text/ng-template" id="addManageActionItemModal.html">
	<div class="modal-header" id="modal-top">
		<button type="button" class="close" ng-click="popupCtrl.cancel('cancel')" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<h3 class="modal-title" ng-if="popupCtrl.isEdit" translate="{{'MANAGE_ACTION'}}"></h3>
		<h3 class="modal-title" ng-if="!popupCtrl.isEdit" translate="{{'ADD_ACTION'}}"></h3>
	</div>
	<div class="modal-body">
		<form class="form form-horizontal" name="formName">
			<div class="form-group">
				<div class="row">
					<label class="control-label col-sm-1" translate="{{'NAME'}}"></label>
					<div class="col-sm-7">
						<input ng-model="popupCtrl.actionItem.name" name="name" type="text" class="form-control" id="areaName" placeholder="{{'ACTION_NAME_PLACEHOLDER' | translate}}"
							   required pattern="^[a-z](?!.*__)[a-z0-9_]*[a-z0-9]$" maxlength="50" ng-model-options="{allowInvalid:true}">
						<ng-messages for="formName.name.$error" ng-if="formName.name.$touched && formName.name.$dirty && formName.name.$invalid || popupCtrl.nameError">
							<ng-message when="required" class="error" translate="{{'VALIDATION_REQUIRED_FIELD'}}"></ng-message>
							<ng-message when="pattern" class="error" translate="{{'VALIDATION_ONLY_ALPHANUMERIC_AND_UNDERSCODE'}}"></ng-message>
							<ng-message when="maxlength" class="error" translate="{{' VALIDATION_LESS_THAN_50_CHARS '}}"></ng-message>
						</ng-messages>
						<small class="error ng-hide" ng-show="popupCtrl.nameError">
							{{popupCtrl.nameMessage}}
						</small>	
						<div class="description ng-hide" ng-show="!popupCtrl.nameError" translate="{{'RECORD_LIST_TAB_ACTIONS_NAME_UNIQUE_DESCRIPTION'}}"></div>					
					</div>
					<label class="control-label col-sm-1" translate="{{'WEIGHT'}}"></label>
					<div class="col-sm-3">
						<input ng-model="popupCtrl.actionItem.weight" type="number" class="form-control" id="weight" name="weight" placeholder="e.g. 2"
							   required pattern="^\d+(\.\d{1,5})?$" ng-model-options="{allowInvalid:true}">
						<ng-messages for="formName.weight.$error" ng-if="formName.weight.$touched && formName.weight.$dirty && formName.weight.$invalid || popupCtrl.weightError">
							<ng-message when="required" class="error" translate="{{'VALIDATION_REQUIRED_FIELD'}}"></ng-message>
							<ng-message when="pattern" class="error" translate="{{'VALIDATION_INTEGER_OR_DECIMAL_2_PLACES'}}"></ng-message>
						</ng-messages>
						<small class="error ng-hide" ng-show="popupCtrl.weightError">
							{{popupCtrl.weightMessage}}
						</small>
					</div>
				</div>
			</div>
			<div class="form-group">
				<div class="row">
					<label class="control-label col-sm-1" translate="{{'MENU'}}"></label>
					<div class="col-sm-7">
						<select class="form-control" ng-model="popupCtrl.actionItem.menu" ng-change="popupCtrl.menuChanged()"
						ng-options="option.value as option.key for option in popupCtrl.menuOptions"></select>
					</div>
				</div>
			</div>
			<div class="form-group">
				<div class="row">
					<label class="control-label col-sm-1" translate="{{'TEMPLATE'}}"></label>
					<div class="col-sm-11">
						<div ui-ace="popupCtrl.aceOptions" ng-model="popupCtrl.actionItem.template" style="height:100px;"></div>						
					</div>
				</div>
			</div>
		</form>
	</div>
	<div class="modal-footer">
		<button ng-if="popupCtrl.isEdit" class="btn btn-link pull-left go-red" ng-click="popupCtrl.delete()" translate="{{'DELETE'}}"></button>
		<button class="btn btn-primary" ng-click="popupCtrl.ok()" ng-hide="popupCtrl.hasError" ng-if="popupCtrl.isEdit" translate="{{'SAVE'}}"></button>
		<button class="btn btn-success" ng-click="popupCtrl.ok()" ng-hide="popupCtrl.hasError" ng-if="!popupCtrl.isEdit" translate="{{'ADD'}}"></button>
		<button class="btn btn-default" ng-click="popupCtrl.cancel()" translate="{{'CANCEL'}}"></button>
	</div>
</script>