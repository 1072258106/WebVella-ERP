<div id="page-title">
	<div id="page-meta">
		<div class="aux-actions">
			<a class="btn btn-danger btn-sm" ng-click="ngCtrl.deleteListModal()"><i class="fa fa-trash-o"></i> Delete list</a>
		</div>
		<div class="meta-label">
			<h4><span class="go-gray">Records' list:</span> {{ngCtrl.list.name}}</h4>
		</div>
	</div>

</div>
<div id="page-body" style="padding-bottom:3em; ">
	<div class="tabbable tabs-left spilled">
		<a class="back" href="#/admin/entities/{{::ngCtrl.entity.name}}/lists"><i class="fa fa-fw fa-arrow-left"></i> <span class="text">Back</span></a>
		<ul class="nav nav-tabs">
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}"><i class="fa fa-fw fa-info-circle"></i> <span class="text">Details</span></a></li>
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}/fields"><i class="fa fa-fw fa-table"></i> <span class="text">Fields</span></a></li>
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}/views"><i class="fa fa-fw fa-file-text-o"></i> <span class="text">Record Views</span></a></li>
			<li class="active"><a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists"><i class="fa fa-fw fa-list"></i> <span class="text">Records Lists</span></a></li>
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}/trees"><i class="fa fa-fw fa-sitemap"></i> <span class="text">Records Trees</span></a></li>
			<li><a href="#/admin/entities/{{::ngCtrl.entity.name}}/relations"><i class="fa fa-fw fa-link"></i> <span class="text">Relations</span></a></li>
		</ul>

	</div>
	<div id="page-text">
		<ul class="nav nav-pills">
			<li role="presentation" class="active">
				<a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists/{{::ngCtrl.list.name}}">Basic info</a>
			</li>
			<li role="presentation">
				<a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists/{{::ngCtrl.list.name}}/content">Content</a>
			</li>
			<li role="presentation">
				<a href="#/admin/entities/{{::ngCtrl.entity.name}}/lists/{{::ngCtrl.list.name}}/action">Actions</a>
			</li>
		</ul>
		<hr class="divider" />
		<div class="view-manage-section">
			<div class="panel panel-default">
				<div class="panel-body">
					<div class="form-horizontal">
						<div class="row">
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">Name</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-readonly">
												<input type="text" class="form-control" disabled value="{{::ngCtrl.list.name}}"></input>
												<span class="input-group-addon"><i class="fa fa-lock fa-fw"></i></span>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">Type</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-updatable">
												<input type="text" class="form-control" disabled editable-select="ngCtrl.list.type"
													   value="{{ngCtrl.list.type}}" e-ng-options="item.key as item.value for item in ngCtrl.listTypeOptions"
													   onbeforesave="ngCtrl.fieldUpdate('type', $data)" e-form="fieldForm_type">
												<span class="input-group-addon" ng-click="fieldForm_type.$show()" ng-hide="fieldForm_type.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">Label</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-updatable">
												<input type="text" class="form-control" disabled editable-text="ngCtrl.list.label"
													   value="{{ngCtrl.list.label}}"
													   onbeforesave="ngCtrl.fieldUpdate('label',$data)" e-form="fieldForm_label">
												<span class="input-group-addon" ng-click="fieldForm_label.$show()" ng-hide="fieldForm_label.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">Weight</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-updatable">
												<input type="text" class="form-control" disabled editable-text="ngCtrl.list.weight"
													   value="{{ngCtrl.list.weight}}"
													   onbeforesave="ngCtrl.fieldUpdate('weight',$data)" e-form="fieldForm_weight">
												<span class="input-group-addon" ng-click="fieldForm_weight.$show()" ng-hide="fieldForm_weight.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">Default</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-updatable">
												<span class="input-group-addon hidden-xs" ng-if="ngCtrl.list.default && !fieldForm_default.$visible">
													<i class="fa fa-check fa-fw go-green"></i>
												</span>
												<span class="input-group-addon hidden-xs" ng-if="!ngCtrl.list.default && !fieldForm_default.$visible">
													<i class="fa fa-times fa-fw go-red"></i>
												</span>
												<input type="text" class="form-control" disabled editable-checkbox="ngCtrl.list.default"
													   e-title="Make this default list?" value="{{ngCtrl.list.default}}"
													   onbeforesave="ngCtrl.fieldUpdate('default',$data)" e-form="fieldForm_default">
												<span class="input-group-addon" ng-click="fieldForm_default.$show()" ng-hide="fieldForm_default.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">System</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-readonly">
												<span class="input-group-addon" ng-if="ngCtrl.list.system">
													<i class="fa fa-check fa-fw go-green"></i>
												</span>
												<span class="input-group-addon" ng-if="!ngCtrl.list.system">
													<i class="fa fa-times fa-fw go-red"></i>
												</span>
												<input type="text" class="form-control" disabled value="{{::ngCtrl.list.system}}"></input>
												<span class="input-group-addon"><i class="fa fa-lock fa-fw"></i></span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">CSS class</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-updatable">
												<input type="text" class="form-control" disabled editable-text="ngCtrl.list.cssClass"
													   value="{{ngCtrl.list.cssClass}}"
													   onbeforesave="ngCtrl.fieldUpdate('cssClass', $data)" e-form="fieldForm_cssClass">
												<span class="input-group-addon" ng-click="fieldForm_cssClass.$show()" ng-hide="fieldForm_cssClass.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
											<div class="form-description">e.g. "hide-header", "table-noborder", "width-2000", "width-2500","width-3000", "width-3500"</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">Icon Name</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-updatable">
												<span class="input-group-addon"><i class="fa fa-{{ngCtrl.list.iconName}} fa-fw"></i></span>
												<input type="text" class="form-control" disabled editable-text="ngCtrl.list.iconName"
													   value="{{ngCtrl.list.iconName}}" onbeforesave="ngCtrl.fieldUpdate('iconName', $data)" e-form="fieldForm_iconName"
													   e-typeahead-template-url="iconTypeaheadTemplate.html" e-uib-typeahead="icon for icon in ngCtrl.icons | filter:$viewValue | limitTo:10">
												<span class="input-group-addon" ng-click="fieldForm_iconName.$show()" ng-hide="fieldForm_iconName.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
											<div class="form-description">review all icons in <a href="http://fortawesome.github.io/Font-Awesome/icons/" target="_blank">Font Awesome site</a> </div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">Visible columns #</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-updatable">
												<input type="text" class="form-control" disabled editable-text="ngCtrl.list.visibleColumnsCount"
													   value="{{ngCtrl.list.visibleColumnsCount}}"
													   onbeforesave="ngCtrl.fieldUpdate('visibleColumnsCount',$data)" e-form="fieldForm_visibleColumnsCount">
												<span class="input-group-addon" ng-click="fieldForm_visibleColumnsCount.$show()" ng-hide="fieldForm_visibleColumnsCount.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-sm-6">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-2">Page size</label>
										<div class="col-lg-10">
											<div class="editable-wrapper input-group editable-updatable">
												<input type="text" class="form-control" disabled editable-text="ngCtrl.list.pageSize"
													   value="{{ngCtrl.list.pageSize}}"
													   onbeforesave="ngCtrl.fieldUpdate('pageSize',$data)" e-form="fieldForm_pageSize">
												<span class="input-group-addon" ng-click="fieldForm_pageSize.$show()" ng-hide="fieldForm_pageSize.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
											<div class="form-description">zero for unlimited</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-12">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-1">Details View Name</label>
										<div class="col-lg-11">
											<div class="editable-wrapper input-group editable-updatable">
												<input type="text" class="form-control" disabled editable-text="ngCtrl.list.viewNameOverride"
													   value="{{ngCtrl.list.viewNameOverride}}"
													   onbeforesave="ngCtrl.fieldUpdate('viewNameOverride',$data)" e-form="fieldForm_viewNameOverride">
												<span class="input-group-addon" ng-click="fieldForm_viewNameOverride.$show()" ng-hide="fieldForm_viewNameOverride.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
											<div class="form-description">Leave blank for the area selected one. You can generate view names on the fly, with "{fieldDataName}" in the string above. DataName needs to be present in the list's data. You can also use "{areaName}", "{entityName}", "{filter}", "{page}", "{searchQuery}". Fields data from relation is supported with the format of its DataName e.g. "{$field$relation_name$label}"</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-12">
								<div class="form-group">
									<div class="editable-field field">
										<label class="control-label col-lg-1">Custom Template</label>
										<div class="col-lg-11">
											<div class="editable-wrapper input-group editable-updatable">
												<span class="input-group-addon" ng-if="!fieldForm_dynamicHtmlTemplate.$visible">
													<a href="{{ngCtrl.view.dynamicHtmlTemplate}}" target="_blank"><i class="fa fa-globe fa-fw"></i></a>
												</span>
												<input type="text" class="form-control" disabled editable-text="ngCtrl.list.dynamicHtmlTemplate"
													   value="{{ngCtrl.renderFieldValue(ngCtrl.list.dynamicHtmlTemplate,{fieldType:18})}}"
													   onbeforesave="ngCtrl.fieldUpdate('dynamicHtmlTemplate', $data)" e-form="fieldForm_dynamicHtmlTemplate">
												<span class="input-group-addon" ng-click="fieldForm_dynamicHtmlTemplate.$show()" ng-hide="fieldForm_dynamicHtmlTemplate.$visible"><i class="fa fa-pencil fa-fw"></i></span>
											</div>
											<div class="form-description">URL to a customer HTML template file that should substitute the default view HTML template. It will be compiled by angular, and view data and meta are accessible.</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>

				</div>
			</div>

			<h3 class="page-header">List Columns</h3>
			<div class="row">
				<div class="col-xs-6">
					<h5>Selected columns <small class="go-gray">| Record Id is always injected in the data. The first column is also the default search column</small></h5>
				</div>
				<div class="col-xs-6">
					<h5>Library</h5>
				</div>
			</div>
			<div class="row">
				<div class="col-xs-6">
					<div class="list-field-selection-box" style="height:250px;">
						<div class="drop-zone">
							<div as-sortable="ngCtrl.dragLibraryListeners" ng-model="ngCtrl.list.columns">
								<div class="dropped-item" ng-model="item" data-as-sortable-item ng-repeat="item in ngCtrl.list.columns track by item.dataName"
									 ng-switch="::item.type">
									<div ng-switch-when="field" class="clearfix">
										<i class="fa fa-fw fa-arrows go-gray pull-left" as-sortable-item-handle></i>
										<a href="javascript:void(0)" class="pull-right" ng-click="ngCtrl.moveToLibrary(item, $index)"><i class="fa fa-fw fa-arrow-right"></i></a>
										<i class="fa fa-fw fa-table go-teal" style="margin-left:10px;"></i> {{::item.meta.name}} <i class="fa fa-fw fa-eye-slash go-red" ng-show="$index + 1 > ngCtrl.list.visibleColumnsCount"></i>
										<i class="fa fa-database go-gray text-small tooltip-btn" tooltip-append-to-body="true" uib-tooltip-template="'dataBindTemplate.html'" tooltip-trigger="outsideClick" tooltip-placement="right" tooltip-class="wva-tooltip"></i>
										<span class="note go-green" ng-show="ngCtrl.defaultFieldName == item.meta.name">(default search)</span>
									</div>
									<div ng-switch-when="fieldFromRelation" class="clearfix">
										<i class="fa fa-fw fa-arrows go-gray pull-left" as-sortable-item-handle></i>
										<a href="javascript:void(0)" class="pull-right" ng-click="ngCtrl.moveToLibrary(item, $index)"><i class="fa fa-fw fa-arrow-right"></i></a>
										<i class="fa fa-fw fa-table go-teal" style="margin-left:10px;"></i> <span class="go-gray">{{::item.relationName}}<span class="divider">></span></span>{{::item.meta.name}} <i class="fa fa-fw fa-eye-slash go-red" ng-show="$index + 1 > ngCtrl.list.visibleColumnsCount"></i>
									</div>
									<div ng-switch-when="view" class="clearfix">
										<i class="fa fa-fw fa-arrows go-gray pull-left" as-sortable-item-handle></i>
										<a href="javascript:void(0)" class="pull-right" ng-click="ngCtrl.moveToLibrary(item, $index)"><i class="fa fa-fw fa-arrow-right"></i></a>
										<i class="fa fa-fw fa-file-text-o go-teal" style="margin-left: 10px;"></i> {{::item.meta.name}} <i class="fa fa-fw fa-eye-slash go-red" ng-show="$index + 1 > ngCtrl.list.visibleColumnsCount"></i>
									</div>
									<div ng-switch-when="viewFromRelation" class="clearfix">
										<i class="fa fa-fw fa-arrows go-gray pull-left" as-sortable-item-handle></i>
										<a href="javascript:void(0)" class="pull-right" ng-click="ngCtrl.moveToLibrary(item, $index)"><i class="fa fa-fw fa-arrow-right"></i></a>
										<i class="fa fa-fw fa-file-text-o go-teal" style="margin-left: 10px;"></i> <span class="go-gray">{{::item.relationName}}<span class="divider">></span></span>{{::item.meta.name}} <i class="fa fa-fw fa-eye-slash go-red" ng-show="$index + 1 > ngCtrl.list.visibleColumnsCount"></i>
									</div>
									<div ng-switch-when="list" class="clearfix">
										<i class="fa fa-fw fa-arrows go-gray pull-left" as-sortable-item-handle></i>
										<a href="javascript:void(0)" class="pull-right" ng-click="ngCtrl.moveToLibrary(item, $index)"><i class="fa fa-fw fa-arrow-right"></i></a>
										<i class="fa fa-fw fa-list go-teal" style="margin-left: 10px;"></i> {{::item.meta.name}} <i class="fa fa-fw fa-eye-slash go-red" ng-show="$index + 1 > ngCtrl.list.visibleColumnsCount"></i>
									</div>
									<div ng-switch-when="listFromRelation" class="clearfix">
										<i class="fa fa-fw fa-arrows go-gray pull-left" as-sortable-item-handle></i>
										<a href="javascript:void(0)" class="pull-right" ng-click="ngCtrl.moveToLibrary(item, $index)"><i class="fa fa-fw fa-arrow-right"></i></a>
										<i class="fa fa-fw fa-list go-teal" style="margin-left:10px;"></i> <span class="go-gray">{{::item.relationName}}<span class="divider">></span></span>{{::item.meta.name}} <i class="fa fa-fw fa-eye-slash go-red" ng-show="$index + 1 > ngCtrl.list.visibleColumnsCount"></i>
									</div>
									<div ng-switch-when="treeFromRelation" class="clearfix">
										<i class="fa fa-fw fa-arrows go-gray pull-left" as-sortable-item-handle></i>
										<a href="javascript:void(0)" class="pull-right" ng-click="ngCtrl.moveToLibrary(item, $index)"><i class="fa fa-fw fa-arrow-right"></i></a>
										<i class="fa fa-fw fa-sitemap go-teal" style="margin-left:10px;"></i> <span class="go-gray">{{::item.relationName}}<span class="divider">></span></span>{{::item.meta.name}} <i class="fa fa-fw fa-eye-slash go-red" ng-show="$index + 1 > ngCtrl.list.visibleColumnsCount"></i>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="col-xs-6">
					<form class="form" style="margin-bottom:1em;padding:0;background:transparent;border:none;">
						<div class="form-group">
							<div class="input-group">
								<span class="input-group-addon"><i class="fa fa-fw fa-search"></i></span>
								<input type="text" ng-model="ngCtrl.search.dataName" class="form-control" style="width:100%;">
							</div>
						</div>
					</form>
					<div style="height:200px;overflow-y:scroll;">
						<div class="drop-zone-disabled">
							<div as-sortable="ngCtrl.dragControlListeners" ng-model="ngCtrl.library.items">
								<div class="dropped-item" ng-model="item" data-as-sortable-item
									 ng-repeat="item in ngCtrl.library.items | filter: ngCtrl.search track by item.dataName"
									 ng-switch="::item.type">
									<div as-sortable-item-handle ng-switch-when="field" class="clearfix">
										<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
										<i class="fa fa-fw fa-table go-teal" style="margin-left:10px;"></i> {{::item.meta.name}}
									</div>
									<div as-sortable-item-handle ng-switch-when="fieldFromRelation" class="clearfix">
										<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
										<i class="fa fa-fw fa-table go-teal" style="margin-left:10px;"></i> <span class="go-gray">{{::item.relationName}}<span class="divider">></span></span>{{::item.meta.name}}
									</div>
									<div as-sortable-item-handle ng-switch-when="view" class="clearfix">
										<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
										<i class="fa fa-fw fa-file-text-o go-teal" style="margin-left: 10px;"></i> {{::item.meta.name}}
									</div>
									<div as-sortable-item-handle ng-switch-when="viewFromRelation" class="clearfix">
										<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
										<i class="fa fa-fw fa-file-text-o go-teal" style="margin-left: 10px;"></i> <span class="go-gray">{{::item.relationName}}<span class="divider">></span></span>{{::item.meta.name}}
									</div>
									<div as-sortable-item-handle ng-switch-when="list" class="clearfix">
										<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
										<i class="fa fa-fw fa-list go-teal" style="margin-left: 10px;"></i> {{::item.meta.name}}
									</div>
									<div as-sortable-item-handle ng-switch-when="listFromRelation" class="clearfix">
										<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
										<i class="fa fa-fw fa-list go-teal" style="margin-left:10px;"></i> <span class="go-gray">{{::item.relationName}}<span class="divider">></span></span>{{::item.meta.name}}
									</div>
									<div as-sortable-item-handle ng-switch-when="treeFromRelation" class="clearfix">
										<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
										<i class="fa fa-fw fa-sitemap go-teal" style="margin-left:10px;"></i> <span class="go-gray">{{::item.relationName}}<span class="divider">></span></span>{{::item.meta.name}}
									</div>
									<div as-sortable-item-handle ng-switch-when="html" class="clearfix">
										<div ng-if='item.tag == ""'>
											<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
											<i class="fa fa-fw fa-code go-teal" style="margin-left:10px;"></i> No tag
										</div>
										<div ng-if='item.tag != ""'>
											<a href="javascript:void(0)" class="pull-left" ng-click="ngCtrl.moveToColumns(item, $index)"><i class="fa fa-fw fa-arrow-left"></i></a>
											<i class="fa fa-fw fa-code go-teal" style="margin-left:10px;"></i> {{::item.tag}}
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<br />
					<table class="table table-bordered">
						<thead>
							<tr>
								<th class="go-bkg-white">relations</th>
								<th width="90" class="go-bkg-white">in library</th>
								<th width="115" class="go-bkg-white">direction</th>
							</tr>
						</thead>
						<tbody>
							<tr ng-repeat="relation in ngCtrl.library.relations track by relation.relationId">
								<td>
									<div style="overflow-x: hidden; -ms-text-overflow: ellipsis; -o-text-overflow: ellipsis; text-overflow: ellipsis;">
										<span ng-show="::ngCtrl.getRelationType(relation.relationId) == 1" class="badge badge-primary badge-inverse ng-hide" title="One to One" style="margin-right:5px;font-size:10px;">1 : 1</span>
										<span ng-show="::ngCtrl.getRelationType(relation.relationId) == 2" class="badge badge-primary badge-inverse ng-hide" title="One to Many" style="margin-right:5px;font-size:10px;">1 : N</span>
										<span ng-show="::ngCtrl.getRelationType(relation.relationId) == 3" class="badge badge-primary badge-inverse ng-hide" title="Many to Many" style="margin-right:5px;font-size:10px;">N : N</span>
										{{::relation.relationName}}
									</div>
								</td>
								<td>
									<a ng-click="ngCtrl.toggleRelationToLibrary(relation)" href="javascript:void(0)" style="color:#2196F3 !important">
										<span class="ng-hide" ng-show="relation.addedToLibrary">remove</span>
										<span class="ng-hide" ng-show="!relation.addedToLibrary">add</span>
									</a>
								</td>
								<td>
									<span class="go-gray" ng-if="!relation.sameOriginTargetEntity" title="only when the origin and target entity is the same in a relation, you can manage the direction">origin ! = target</span>
									<a ng-click="ngCtrl.changeRelationDirection(relation)" href="javascript:void(0)" style="color:#2196F3 !important" ng-if="relation.sameOriginTargetEntity">
										<span class="ng-hide" ng-show="relation.direction == 'origin-target'">origin > target</span>
										<span class="ng-hide" ng-show="relation.direction == 'target-origin'"><span class="go-red">target</span> > origin</span>
									</a>
								</td>
							</tr>
						</tbody>
					</table>
				</div>

			</div>


			<h3 class="page-header">Query</h3>
			<div ng-if="ngCtrl.list.query == null"><a class="btn btn-default" ng-click="ngCtrl.AddSection(null)">add query section</a></div>
			<div ng-if="ngCtrl.list.query != null">
				<query-item current-query="ngCtrl.list.query" parent-query="null" root-query="ngCtrl.list.query" page-scope="ngCtrl" query-index="0"></query-item>
			</div>

			<h3 class="page-header">Sort</h3>
			<div ng-show="ngCtrl.list.sorts == null || ngCtrl.list.sorts.length == 0" class="ng-hide"><a class="btn btn-default" ng-click="ngCtrl.AddSortRule()">add new sort</a></div>
			<div class="panel panel-default" ng-hide="ngCtrl.list.sorts == null || ngCtrl.list.sorts.length == 0">
				<div class="panel-heading clearfix">
					<span class="pull-right">
						<a class="btn btn-default btn-sm" ng-click="ngCtrl.AddSortRule()">add new sort</a>
					</span>
				</div>
				<div class="panel-body">
					<table class="table table-noborder table-vertical-align-middle">
						<tr ng-repeat="sortRule in ngCtrl.list.sorts">
							<td style="width:60px"><span ng-if="$index == 0">first</span><span ng-if="$index != 0">than</span></td>
							<td>
								<select class="form-control" ng-model="sortRule.sortType" ng-change="ngCtrl.updateSorts()">
									<option value="ascending">sort from low to high by</option>
									<option value="descending">sort from high to low by</option>
								</select>
							</td>
							<td>
								<select class="form-control" ng-model="sortRule.fieldName" ng-change="ngCtrl.updateSorts()" ng-options="item.fieldName as item.meta.name for item in ngCtrl.onlyFieldsLibrary.items"></select>
							</td>
							<td style="width:60px;">
								<a class="btn btn-default go-red" ng-click="ngCtrl.DeleteSortRule($index)"><i class="fa fa-fw fa-close"></i></a>
							</td>
						</tr>
					</table>
				</div>
			</div>

		</div>

	</div>
</div>

<script type="text/ng-template" id="deleteListModal.html">
	<div class="modal-header" id="modal-top">
		<button type="button" class="close" ng-click="popupCtrl.cancel('cancel')" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<h3 class="modal-title">Delete a list</h3>
	</div>
	<div class="modal-body">
		<div class="alert alert-danger" ng-bind="popupCtrl.errorMessage" ng-show="popupCtrl.hasError"></div>
		<div ng-hide="popupCtrl.hasError">
			<p>Are you sure that you need this list deleted?</p>
		</div>
	</div>
	<div class="modal-footer">
		<button class="btn btn-danger" ng-click="popupCtrl.ok()" ng-hide="popupCtrl.hasError">Delete List</button>
		<button class="btn btn-default" ng-click="popupCtrl.cancel()">Cancel</button>
	</div>
</script>

<script type="text/ng-template" id="iconTypeaheadTemplate.html">
	<a class="typeahead-icon-item">
		<i class="fa fa-{{match.model}} fa-fw go-gray"></i>
		<span ng-bind-html="match.model | uibTypeaheadHighlight:query"></span>
	</a>
</script>

<script type="text/ng-template" id="queryRule.html">
	<table class="table table-noborder table-vertical-align-middle">
		<tr>
			<td style="width:30px;">
				<a class="btn btn-default" ng-click="ngCtrl.manageQueryDataLink(currentQuery)"><i class="fa fa-fw fa-database go-grey"></i></a>
			</td>
			<td  width="250">
				<select class="form-control" ng-model="currentQuery.fieldName" ng-change="ngCtrl.updateQuery()" ng-options="item.fieldName as item.meta.name for item in ngCtrl.onlyFieldsLibrary.items"></select>
			</td>
			<td  width="200">
				<select class="form-control" ng-model="currentQuery.queryType" ng-change="ngCtrl.updateQuery()" ng-options="item.key as item.value for item in ngCtrl.getQueryComparisonOptionsList(currentQuery)"></select>
			</td>
			<!--<td  width="130">
				<select class="form-control" disabled>
					<option value="val" selected="">the value</option>
				</select>
			</td>-->
			<td class="position-relative">
				<div class="editable-wrapper input-group editable-updatable">
					<input type="text" class="form-control" disabled editable-text="currentQuery.fieldValue"
						   value="{{currentQuery.fieldValue}}"
						   onaftersave="ngCtrl.updateQuery()" e-form="{{'queryForm_' + queryIndex}}">
					<span class="input-group-addon" ng-click="this['queryForm_' + queryIndex].$show()" ng-hide="this['queryForm_' + queryIndex].$visible"><i class="fa fa-pencil fa-fw"></i></span>
				</div>
			</td>
			<td style="width:60px;">
				<a ng-hide="parentQuery.subQueries.length <= 1" class="btn btn-default go-red" ng-click="ngCtrl.DeleteItem(parentQuery, queryIndex)"><i class="fa fa-fw fa-close"></i></a>
				<span ng-hide="parentQuery.subQueries.length > 1" class="btn go-red " uib-tooltip="section needs to have at least one rule"><i class="fa fa-fw fa-lock"></i></span>
			</td>
		</tr>
	</table>
</script>

<script type="text/ng-template" id="querySection.html">
	<div class="panel panel-default">
		<div class="panel-heading clearfix">
			<span class="pull-right">
				<a class="btn btn-default go-red btn-sm" ng-click="ngCtrl.DeleteItem(parentQuery, queryIndex)"><i class="fa fa-fw fa-close"></i></a>
				<a class="btn btn-default btn-sm" ng-click="ngCtrl.AddSection(currentQuery)">add section</a>
				<a class="btn btn-default btn-sm" ng-click="ngCtrl.AddRule(currentQuery)">add rule</a>
			</span>
			<select class="form-control pull-left" style="width:80px;" ng-model="currentQuery.queryType" ng-change="ngCtrl.updateQuery()">
				<option value="AND">all</option>
				<option value="OR">any</option>
			</select>
			<span class="pull-left" style="line-height:30px;margin-left:5px;">of these rules should be true</span>
		</div>
		<div class="panel-body">
			<!--<div ng-repeat="query in parentQuery.subQueries" ng-include="ngCtrl.getIncludeFile(query)" onload="parent = parentQuery; parentQuery = query"></div>-->
			<query-item ng-repeat="queryItem in currentQuery.subQueries"
						current-query="queryItem" parent-query="currentQuery"
						root-query="ngCtrl.list.query" page-scope="ngCtrl"
						query-index="$index"></query-item>
		</div>
	</div>

</script>

<script type="text/ng-template" id="manageDataLinkModal.html">
	<div class="modal-header" id="modal-top">
		<button type="button" class="close" ng-click="popupCtrl.cancel('cancel')" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		<h3 class="modal-title">Manage data link for the rule</h3>
	</div>
	<div class="modal-body">
		<p>In the most right input of this query rule row, you can set a static value or a dynamic one. The static value will be used as is. You can dynamically pass values to the query rule by using predefined data-link JSON objects.</p>
		<h4>current_user</h4>
		<pre class="ng-binding">Example: {"name":"current_user", "option": "id", "default": null, "settings":{}}</pre>
		<table class="table table-bordered">
			<thead>
				<tr>
					<th width="100">attributes</th>
					<th width="80">type</th>
					<th width="150">value</th>
					<th>description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><span class="go-green">name</span></td>
					<td><span class="go-grey">string</span></td>
					<td><span class="go-blue">current_user</span></td>
					<td>Check the currently authenticated user, if there is such.</td>
				</tr>
				<tr>
					<td><span class="go-green">option</span></td>
					<td><span class="go-grey">string</span></td>
					<td><span class="go-blue">id</span></td>
					<td>The "id" field of the current user is the only option available for now</td>
				</tr>
				<tr>
					<td><span class="go-green">default</span></td>
					<td><span class="go-grey">string</span></td>
					<td>
						<ul style="margin:0;padding-left:16px;">
							<li><span class="go-blue">null</span></li>
							<li><span class="go-blue">"valid guid"</span></li>
						</ul>
					</td>
					<td>if there is no authenticated user, the returned null value can be replaces with "guid" of your own. Set 'null', if you do not want a default value</td>
				</tr>
				<tr>
					<td><span class="go-green">settings</span></td>
					<td><span class="go-grey">object</span></td>
					<td><span class="go-blue">{}</span></td>
					<td>there are not settings for this data-link object currently, so you need to set an empty object.</td>
				</tr>
			</tbody>
		</table>
		<h4>current_date</h4>
		<pre class="ng-binding">Example: {"name":"current_date", "option": "datetime", "default": null, "settings":{year:null,month:null,day:-1,hour:null,minute:null}}</pre>
		<table class="table table-bordered">
			<thead>
				<tr>
					<th width="100">attributes</th>
					<th width="80">type</th>
					<th width="150">value</th>
					<th>description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><span class="go-green">name</span></td>
					<td><span class="go-grey">string</span></td>
					<td><span class="go-blue">current_date</span></td>
					<td>Get and manipulates the current date in UTC.</td>
				</tr>
				<tr>
					<td><span class="go-green">option</span></td>
					<td><span class="go-grey">string</span></td>
					<td>
						<ul style="margin:0;padding-left:16px;">
							<li><span class="go-blue">date</span></li>
							<li><span class="go-blue">datetime</span></li>
						</ul>
					</td>
					<td>Sets the ZERO HOUR date or the exact current date and hour in UTC</td>
				</tr>
				<tr>
					<td><span class="go-green">default</span></td>
					<td><span class="go-grey">string</span></td>
					<td>
						<span class="go-blue">null</span>
					</td>
					<td>No need for default value as current date is always available.</td>
				</tr>
				<tr>
					<td><span class="go-green">settings</span></td>
					<td><span class="go-grey">object</span></td>
					<td>
					<span class="go-blue">
						{<br/>
						"year":null,<br/>
						"month":null,<br/>
						"day":null,<br/>
						"hour":null,<br/>
						"minute":null,<br/>
						}
					</span>
					</td>
					<td>with the settings object you can manipulate the current date or datetime, by subtracting or adding periods to it.<br/> Example: "year":-1, will mean that you want the result date or datetime to be the current one minus 1 year.</td>
				</tr>
			</tbody>
		</table>
		<h4>url_query</h4>
		<pre class="ng-binding">Example: {"name":"url_query", "option": "some_query_key", "default": "some_value", "settings":{}}</pre>
		<table class="table table-bordered">
			<thead>
				<tr>
					<th width="100">attributes</th>
					<th width="80">type</th>
					<th width="150">value</th>
					<th>description</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><span class="go-green">name</span></td>
					<td><span class="go-grey">string</span></td>
					<td><span class="go-blue">url_query</span></td>
					<td>The list controller will check the query parameters for keys that match the set string in the "options" attribute. If no match is found, it will use the default value. 
					More than one rule can match the same query parameter key. <strong>The query parameter value should be encoded.</strong> The same value needs to be converted without an error 
					to the data format of the selected rule field. If an error occurs the default value will be returned instead.</td>
				</tr>
				<tr>
					<td><span class="go-green">option</span></td>
					<td><span class="go-grey">string</span></td>
					<td><span class="go-gray">user defined string</span></td>
					<td>The query key that needs to be matched. t needs to comply with the rules for the url strings.</td>
				</tr>
				<tr>
					<td><span class="go-green">default</span></td>
					<td><span class="go-grey">string</span></td>
					<td>
						<ul style="margin:0;padding-left:16px;">
							<li><span class="go-blue">null</span></li>
							<li><span class="go-blue">"string"</span></li>
						</ul>
					</td>
					<td>If not "null", the value needs to be converted without an error to the data format of the selected rule field. If an error occurs, it will not be used by the system, and will be 
					equivalent to "null". The data and DateTime value format is expected to be in ISO 8601 format, in UTC and without timezone (e.g. '2016-04-13T12:23:46Z')</td>
				</tr>
				<tr>
					<td><span class="go-green">settings</span></td>
					<td><span class="go-grey">object</span></td>
					<td><span class="go-blue">{}</span></td>
					<td>there are not settings for this data-link object currently, so you need to set an empty object.</td>
				</tr>
			</tbody>
		</table>
	</div>
	<div class="modal-footer">
		<button class="btn btn-default" ng-click="popupCtrl.cancel()">Cancel</button>
	</div>
</script>

<script type="text/ng-template" id="dataBindTemplate.html">
	<div class="tooltip-description">You can get this field data in a dynamic template by:</div>
	<div class="tooltip-databind"><span>{</span>{templateData[0].{{item.dataName}}<span>}</span>}</div>
	<div class="tooltip-description">[0] is the index of the record in the list. List meta is accessible via:</div>
	<div class="tooltip-databind"><span>{</span>{templateMeta<span>}</span>}</div>
</script>